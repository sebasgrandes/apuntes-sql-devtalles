# Sección 9: Generación de llaves primarias

## UUIDs

https://www.postgresql.org/docs/current/uuid-ossp.html

## Códigos de Práctica

```SQL

-- RECUERDA QUE EL OBJETIVO DE LA LLAVE PRIMARIA ES IDENTIFICAR UN REGISTRO DE FORMA ÚNICA


-- *** SERIAL vs IDENTITY

-- SERIAL: podemos modificar a nuestro gusto y preferencia los user_id (aunque nos salga error)
CREATE TABLE "users" (
	"user_id" SERIAL PRIMARY KEY,
	"username" VARCHAR
);

-- IDENTITY
-- El identity nos da más control: permitiendonos hacer cierto tipo de restriccion que el serial no nos ofrece.

-- este es un identity "DEFAULT": casi similar al serial
CREATE TABLE "users2" (
	"user_id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	"username" VARCHAR
);

-- este es un identity "ALWAYS": los codigos del user_id no se pueden cambiar
CREATE TABLE "users3" (
	"user_id" INTEGER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
	"username" VARCHAR
);

-- este es un identity "ALWAYS" personalizado
CREATE TABLE "users4" (
	"user_id" INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 100 INCREMENT BY 2) PRIMARY KEY,
	"username" VARCHAR
);


-- *** Llave primaria compuesta
-- basicamente decimos que la combinacion jamas se va a repetir... se asegura que la combinación sea unica
CREATE TABLE usersDual (
	id1 int,
	id2 int,
	PRIMARY KEY (id1, id2)
);


-- *** UUIDs
-- UUIDs son identificadores unicos

SELECT gen_random_uuid();

-- creando una extension (funcion) para usar un uuid especifico
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

SELECT uuid_generate_v4();

DROP EXTENSION "uuid-ossp"; -- borrando esa extension

-- creando una tabla con uuid
CREATE TABLE users5(
	"user_id" UUID DEFAULT uuid_generate_v4() PRIMARY KEY, -- establece un uuid a los registros que insertes
	"username" VARCHAR
);


-- *** Secuencias

-- puedes ver las secuencias con: Ctrl + P -> "sequence.."

CREATE SEQUENCE user_sequence;
DROP SEQUENCE user_sequence;

SELECT nextval('user_sequence'); -- cada que lo llames, en cualquier lugar, no vuelve atrás... se reserva el espacio. (si se puede resetear el valor de la secuencia pero con comandos... de igual manera no deberias hacerlo)

SELECT currval('user_sequence'), nextval('user_sequence'), currval('user_sequence');

CREATE TABLE users6 (
	"user_id" INTEGER PRIMARY KEY DEFAULT nextval('user_sequence'),
	"username" VARCHAR
);


```
